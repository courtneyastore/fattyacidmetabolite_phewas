geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("Z-score-Omega-3 fatty acids x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="blue4", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
o3fa_plt
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/MetaboliteXAnthropometric/ObesityO3FAZscore_anthropometric.pdf",plot=o3fa_plt,height=9,width = 38,dpi=300)
pgs_o3fa_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO3FAObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o3fa_bmi_genetic_df <- pgs_o3fa_bmi_genetic_df[c('phecode_id','zscoreBMI_scalePRS_pval')]
colnames(pgs_o3fa_bmi_genetic_df) <- c("phecode","p")
pgs_o3fa_bmi_genetic_df$environment <- "BMI"
pgs_o3fa_bmi_genetic_df <- merge(pgs_o3fa_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_o3fa_bmi_genetic_df[pgs_o3fa_bmi_genetic_df$p < 0.05, ])
pgs_o3fa_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO3FAObesityWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o3fa_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO3FAObesityeWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o3fa_whr_genetic_df <- pgs_o3fa_whr_genetic_df[c('phecode_id','zscoreWHR_scalePRS_pval')]
colnames(pgs_o3fa_whr_genetic_df) <- c("phecode","p")
pgs_o3fa_whr_genetic_df$environment <- "WHR"
pgs_o3fa_whr_genetic_df <- merge(pgs_o3fa_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_o3fa_whr_genetic_df[pgs_o3fa_whr_genetic_df$p < 0.05, ])
pgs_o3fa_plt <- ggplot(pgs_o3fa_final_df, aes(x=phenotype, y=environment)) +
geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("PGS-Omega-3 fatty acids x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="blue4", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
pgs_o3fa_final_df <- rbind(pgs_o3fa_whr_genetic_df,pgs_o3fa_bmi_genetic_df)
pgs_o3fa_final_df$p_label <- ifelse(pgs_o3fa_final_df$p < 0.05, "*","")
pgs_o3fa_final_df$p_label <- ifelse(pgs_o3fa_final_df$p_label == "*" & pgs_o3fa_final_df$p < 0.001, "**",pgs_o3fa_final_df$p_label)
pgs_o3fa_final_df$p_label <- ifelse(pgs_o3fa_final_df$p_label == "**" & pgs_o3fa_final_df$p < 0.0001, "***",pgs_o3fa_final_df$p_label)
pgs_o3fa_plt <- ggplot(pgs_o3fa_final_df, aes(x=phenotype, y=environment)) +
geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("PGS-Omega-3 fatty acids x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="blue4", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
pgs_o3fa_plt
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/MetaboliteXAnthropometric/ObesityO3FAPGS_anthropometric.pdf",plot=pgs_o3fa_plt,height=9,width = 38,dpi=300)
#------------------ Non-genetic O6FA--------------------------
o6fa_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/O6FAzscoreObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
o6fa_bmi_genetic_df <- o6fa_bmi_genetic_df[c('phecode_id','zscoreBMI_zscoreO6FA_pval')]
colnames(o6fa_bmi_genetic_df) <- c("phecode","p")
o6fa_bmi_genetic_df$environment <- "BMI"
o6fa_bmi_genetic_df <- merge(o6fa_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(o6fa_bmi_genetic_df[o6fa_bmi_genetic_df$p < 0.05, ])
o6fa_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/O6FAzscoreObesityWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
o6fa_whr_genetic_df <- o6fa_whr_genetic_df[c('phecode_id','zscoreWHR_zscoreO6FA_pval')]
colnames(o6fa_whr_genetic_df) <- c("phecode","p")
o6fa_whr_genetic_df$environment <- "WHR"
o6fa_whr_genetic_df <- merge(o6fa_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(o6fa_whr_genetic_df[o6fa_whr_genetic_df$p < 0.05, ])
o6fa_final_df <- rbind(o6fa_whr_genetic_df,o6fa_bmi_genetic_df)
o6fa_final_df$p_label <- ifelse(o6fa_final_df$p < 0.05, "*","")
o6fa_final_df$p_label <- ifelse(o6fa_final_df$p_label == "*" & o6fa_final_df$p < 0.001, "**",o6fa_final_df$p_label)
o6fa_final_df$p_label <- ifelse(o6fa_final_df$p_label == "**" & o6fa_final_df$p < 0.0001, "***",o6fa_final_df$p_label)
o6fa_plt <- ggplot(o6fa_final_df, aes(x=phenotype, y=environment)) +
geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("Z-score-Omega-6 fatty acids x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="#097969", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
o6fa_plt
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/MetaboliteXAnthropometric/ObesityO6FAZscore_anthropometric.pdf",plot=o6fa_plt,height=9,width = 38,dpi=300)
#------------------ Genetic O6FA--------------------------
pgs_o6fa_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO6FAObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o6fa_bmi_genetic_df <- pgs_o6fa_bmi_genetic_df[c('phecode_id','zscoreBMI_scalePRS_pval')]
colnames(pgs_o6fa_bmi_genetic_df) <- c("phecode","p")
pgs_o6fa_bmi_genetic_df$environment <- "BMI"
pgs_o6fa_bmi_genetic_df <- merge(pgs_o6fa_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_o6fa_bmi_genetic_df[pgs_o6fa_bmi_genetic_df$p < 0.05, ])
pgs_o6fa_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO6FAObesityWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o6fa_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO6FAObesityeWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o6fa_whr_genetic_df <- pgs_o6fa_whr_genetic_df[c('phecode_id','zscoreWHR_scalePRS_pval')]
colnames(pgs_o6fa_whr_genetic_df) <- c("phecode","p")
pgs_o6fa_whr_genetic_df$environment <- "WHR"
pgs_o6fa_whr_genetic_df <- merge(pgs_o6fa_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_o6fa_whr_genetic_df[pgs_o6fa_whr_genetic_df$p < 0.05, ])
pgs_o6fa_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO6FAObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o6fa_bmi_genetic_df <- pgs_o6fa_bmi_genetic_df[c('phecode_id','zscoreBMI_scalePRS_pval')]
colnames(pgs_o6fa_bmi_genetic_df) <- c("phecode","p")
pgs_o6fa_bmi_genetic_df$environment <- "BMI"
pgs_o6fa_bmi_genetic_df <- merge(pgs_o6fa_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_o6fa_bmi_genetic_df[pgs_o6fa_bmi_genetic_df$p < 0.05, ])
pgs_o6fa_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSO6FAObesityeWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_o6fa_whr_genetic_df <- pgs_o6fa_whr_genetic_df[c('phecode_id','zscoreWHR_scalePRS_pval')]
colnames(pgs_o6fa_whr_genetic_df) <- c("phecode","p")
pgs_o6fa_whr_genetic_df$environment <- "WHR"
pgs_o6fa_whr_genetic_df <- merge(pgs_o6fa_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_o6fa_whr_genetic_df[pgs_o6fa_whr_genetic_df$p < 0.05, ])
pgs_o6fa_final_df <- rbind(pgs_o6fa_whr_genetic_df,pgs_o6fa_bmi_genetic_df)
pgs_o6fa_final_df$p_label <- ifelse(pgs_o6fa_final_df$p < 0.05, "*","")
pgs_o6fa_final_df$p_label <- ifelse(pgs_o6fa_final_df$p_label == "*" & pgs_o6fa_final_df$p < 0.001, "**",pgs_o6fa_final_df$p_label)
pgs_o6fa_final_df$p_label <- ifelse(pgs_o6fa_final_df$p_label == "**" & pgs_o6fa_final_df$p < 0.0001, "***",pgs_o6fa_final_df$p_label)
pgs_o6fa_plt <- ggplot(pgs_o6fa_final_df, aes(x=phenotype, y=environment)) +
geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("PGS-Omega-6 fatty acids x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="#097969", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
pgs_o6fa_plt
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/MetaboliteXAnthropometric/ObesityO6FAPGS_anthropometric.pdf",plot=pgs_o6fa_plt,height=9,width = 38,dpi=300)
dha_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/DHAzscoreObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
dha_bmi_genetic_df <- dha_bmi_genetic_df[c('phecode_id','zscoreBMI_zscoreDHA_pval')]
colnames(dha_bmi_genetic_df) <- c("phecode","p")
dha_bmi_genetic_df$environment <- "BMI"
dha_bmi_genetic_df <- merge(dha_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(dha_bmi_genetic_df[dha_bmi_genetic_df$p < 0.05, ])
dha_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/DHAzscoreObesityWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
dha_whr_genetic_df <- dha_whr_genetic_df[c('phecode_id','zscoreWHR_zscoreDHA_pval')]
colnames(dha_whr_genetic_df) <- c("phecode","p")
dha_whr_genetic_df$environment <- "WHR"
dha_whr_genetic_df <- merge(dha_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(dha_whr_genetic_df[dha_whr_genetic_df$p < 0.05, ])
dha_final_df <- rbind(dha_whr_genetic_df,dha_bmi_genetic_df)
dha_final_df$p_label <- ifelse(dha_final_df$p < 0.05, "*","")
dha_final_df$p_label <- ifelse(dha_final_df$p_label == "*" & dha_final_df$p < 0.001, "**",dha_final_df$p_label)
dha_final_df$p_label <- ifelse(dha_final_df$p_label == "**" & dha_final_df$p < 0.0001, "***",dha_final_df$p_label)
dha_plt <- ggplot(dha_final_df, aes(x=phenotype, y=environment)) +
geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("Z-score-Docosahexaenoic acid x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="#ff781f", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
dha_plt
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/MetaboliteXAnthropometric/ObesityDHAZscore_anthropometric.pdf",plot=dha_plt,height=9,width = 65,dpi=300,limitsize = FALSE)
pgs_dha_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSDHAObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_dha_bmi_genetic_df <- pgs_dha_bmi_genetic_df[c('phecode_id','zscoreBMI_scalePRS_pval')]
colnames(pgs_dha_bmi_genetic_df) <- c("phecode","p")
pgs_dha_bmi_genetic_df$environment <- "BMI"
pgs_dha_bmi_genetic_df <- merge(pgs_dha_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_dha_bmi_genetic_df[pgs_dha_bmi_genetic_df$p < 0.05, ])
pgs_dha_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSDHAObesityWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_dha_whr_genetic_df <- pgs_dha_whr_genetic_df[c('phecode_id','zscoreWHR_scalePRS_pval')]
colnames(pgs_dha_whr_genetic_df) <- c("phecode","p")
pgs_dha_whr_genetic_df$environment <- "WHR"
pgs_dha_whr_genetic_df <- merge(pgs_dha_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_dha_whr_genetic_df[pgs_dha_whr_genetic_df$p < 0.05, ])
#------------------ Genetic DHA--------------------------
pgs_dha_bmi_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSDHAObesityBMI_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_dha_bmi_genetic_df <- pgs_dha_bmi_genetic_df[c('phecode_id','zscoreBMI_scalePRS_pval')]
colnames(pgs_dha_bmi_genetic_df) <- c("phecode","p")
pgs_dha_bmi_genetic_df$environment <- "BMI"
pgs_dha_bmi_genetic_df <- merge(pgs_dha_bmi_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_dha_bmi_genetic_df[pgs_dha_bmi_genetic_df$p < 0.05, ])
pgs_dha_whr_genetic_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/BMIWHR_results/PGSDHAObesityWHR_Interaction_logisticRegression_MRsupportdiseases.tsv"))
pgs_dha_whr_genetic_df <- pgs_dha_whr_genetic_df[c('phecode_id','zscoreWHR_scalePRS_pval')]
colnames(pgs_dha_whr_genetic_df) <- c("phecode","p")
pgs_dha_whr_genetic_df$environment <- "WHR"
pgs_dha_whr_genetic_df <- merge(pgs_dha_whr_genetic_df,map_phecode_df,by = "phecode")
nrow(pgs_dha_whr_genetic_df[pgs_dha_whr_genetic_df$p < 0.05, ])
pgs_dha_final_df <- rbind(pgs_dha_whr_genetic_df,pgs_dha_bmi_genetic_df)
#pgs_dha_final_df$p_label <- ifelse(pgs_dha_final_df$p < 0.05, round(-log10(pgs_dha_final_df$p),2),"")
pgs_dha_final_df$p_label <- ifelse(pgs_dha_final_df$p < 0.05, "*","")
pgs_dha_final_df$p_label <- ifelse(pgs_dha_final_df$p_label == "*" & pgs_dha_final_df$p < 0.001, "**",pgs_dha_final_df$p_label)
pgs_dha_final_df$p_label <- ifelse(pgs_dha_final_df$p_label == "**" & pgs_dha_final_df$p < 0.0001, "***",pgs_dha_final_df$p_label)
pgs_dha_plt <- ggplot(pgs_dha_final_df, aes(x=phenotype, y=environment)) +
geom_tile(aes(fill= -log10(p))) +
geom_text(aes(label=p_label),size=10) +
xlab("") + ylab("") + ggtitle("PGS-Docosahexaenoic acid x Body weight measurements (Obese/Non-obese)") +
theme_classic() +
theme(axis.text.x = element_text(size = 20,angle = 45, hjust=1),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1)) +
scale_fill_gradient2(low="white", high="#ff781f", guide="colorbar",limits=c(0,22.5)) + facet_grid(. ~ category, scales = "free_x", space='free')
pgs_dha_plt
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/MetaboliteXAnthropometric/ObesityDHAPGS_anthropometric.pdf",plot=pgs_dha_plt,height=9,width = 65,dpi=300,limitsize = FALSE)
library(ggplot2)
library(forcats)
library(tidyverse)
library(dplyr)
library(data.table)
library("ggpubr")
library(plyr)
library(stringr)
library(gridExtra)
library(ggrepel)
library(viridis)
library(hrbrthemes)
library(circlize)
circos.par("track.height" = 0.4)
options(ggrepel.max.overlaps = Inf)
obesity_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/obesity.tsv"))
omega3_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/omega3.tsv"))
omega3_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/omega-3.tsv"))
diabetes_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/Type2diabetes.tsv"))
head(obesity_df)
obesity_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/obesity.tsv"))
obesity_genes <- unique(obesity_df$symbol)
omega3_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/omega-3.tsv"))
omega3_genes <- unique(omega3_df$symbol)
diabetes_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/OpenTargets_Analysis/Type2diabetes.tsv"))
diabetes_genes <- unique(diabetes_df$symbol)
diabetes_genes
omega3_genes
obesity_genes
library(tidyverse)
library(tidyverse)
library(data.table)
library(TwoSampleMR)
library(MendelianRandomization)
library(MRInstruments)
library(MRPRESSO)
library(RadialMR)
library(ggrepel)
exp_dat <- extract_instruments(outcomes="ukb-b-15541")
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "met-d-omega3",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- harmonise_data(exp_dat,out_dat)
exp_dat <- extract_instruments(outcomes="ukb-b-15541")
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "met-d-Omega_3",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- harmonise_data(exp_dat,out_dat)
mr(dat_ivw)
exp_dat <- extract_instruments(outcomes="ieu-a-90")
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "met-d-Omega_3",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- harmonise_data(exp_dat,out_dat)
mr(dat_ivw)
mr(dat)
exp_dat <- extract_instruments(outcomes="met-d-Omega_3")
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "ieu-a-90",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- harmonise_data(exp_dat,out_dat)
mr(dat)
mv_extract_exposures(
c('met-d-Omega_3','ieu-a-90'),
clump_r2 = 0.001,
clump_kb = 10000,
harmonise_strictness = 2,
access_token = ieugwasr::check_access_token(),
find_proxies = TRUE,
force_server = FALSE,
pval_threshold = 5e-08
)
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "ebi-a-GCST006867",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- mv_harmonise_data(omega3_obesity_dat, out_dat, harmonise_strictness = 2)
omega3_obesity_dat <- mv_extract_exposures(
c('met-d-Omega_3','ieu-a-90'),
clump_r2 = 0.001,
clump_kb = 10000,
harmonise_strictness = 2,
access_token = ieugwasr::check_access_token(),
find_proxies = TRUE,
force_server = FALSE,
pval_threshold = 5e-08
)
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "ebi-a-GCST006867",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- mv_harmonise_data(omega3_obesity_dat, out_dat, harmonise_strictness = 2)
mv_res <- mv_multiple(dat)
mv_res
exp_dat <- extract_instruments(outcomes="met-d-Omega_3")
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "ebi-a-GCST006867",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- harmonise_data(exp_dat,out_dat)
mr(dat)
mv_res
mv_res <- mv_basic(dat)
out_dat <- extract_outcome_data(snps = exp_dat$SNP, outcomes = "ebi-a-GCST006867",access_token=NULL,proxies = 1, rsq = 0.8, align_alleles = 1, palindromes = 1, maf_threshold = 0.3)
dat <- mv_harmonise_data(omega3_obesity_dat, out_dat, harmonise_strictness = 2)
mv_res <- mv_basic(dat,pval_threshold = 5e-08)
intersect(c(obesity_genes,omega3_genes), diabetes_genes)
intersect(obesity_genes, diabetes_genes)
intersect(obesity_genes, omega3_genes)
intersect(diabetes_genes, omega3_genes)
diabetes_genes
library(ggplot2)
library(forcats)
library(tidyverse)
library(dplyr)
library(data.table)
library("ggpubr")
library(plyr)
library(stringr)
library(gridExtra)
library(ggrepel)
library(viridis)
library(hrbrthemes)
library(circlize)
circos.par("track.height" = 0.4)
options(ggrepel.max.overlaps = Inf)
capFirst <- function(s) {
paste(toupper(substring(s, 1, 1)), substring(s, 2), sep = "")
}
p_thresh = 0.05/(1326*6)
phecode_map_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/phecode_definitions1.2.csv"))
phecode_map_df$phecode <- as.character(phecode_map_df$phecode)
phecode_map_df$category <- capFirst(phecode_map_df$category)
# Read and format O3FA genetic results
o3fa_prs_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/result_files/MASTER_01_16_2023_Phecodes_PRS_O3FA_age_agesquare_sex_10PCS_glmresults.tsv"))
o3fa_prs_df$phecode <- as.character(o3fa_prs_df$phecode)
o3fa_prs_df$label <- "Omega-3 fatty acids"
o3fa_prs_df <- merge(o3fa_prs_df,phecode_map_df,by="phecode")
o3fa_prs_df <- o3fa_prs_df[o3fa_prs_df$category != "NULL", ]
o3fa_prs_df <- o3fa_prs_df[!(is.na(o3fa_prs_df$category)), ]
o3fa_prs_df <- o3fa_prs_df[o3fa_prs_df$category != "", ]
o3fa_prs_df$significance <- ifelse(o3fa_prs_df$pval< p_thresh, o3fa_prs_df$phenotype, "")
o3fa_prs_df$risk_prot <- ifelse(o3fa_prs_df$or > 1, "Risk", "Protective")
# Read and format O6FA genetic results
o6fa_prs_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/result_files/MASTER_01_16_2023_Phecodes_PRS_O6FA_age_agesquare_sex_10PCS_glmresults.tsv"))
o6fa_prs_df$phecode <- as.character(o6fa_prs_df$phecode)
o6fa_prs_df$label <- "Omega-6 fatty acids"
o6fa_prs_df <- merge(o6fa_prs_df,phecode_map_df,by="phecode")
o6fa_prs_df <- o6fa_prs_df[o6fa_prs_df$category != "NULL", ]
o6fa_prs_df <- o6fa_prs_df[!(is.na(o6fa_prs_df$category)), ]
o6fa_prs_df <- o6fa_prs_df[o6fa_prs_df$category != "", ]
o6fa_prs_df$significance <- ifelse(o6fa_prs_df$pval< p_thresh, o6fa_prs_df$phenotype, "")
o6fa_prs_df$risk_prot <- ifelse(o6fa_prs_df$or > 1, "Risk", "Protective")
# Read and format DHA genetic results
dha_prs_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/result_files/MASTER_01_16_2023_Phecodes_PRS_DHA_age_agesquare_sex_10PCS_glmresults.tsv"))
dha_prs_df$phecode <- as.character(dha_prs_df$phecode)
dha_prs_df$label <- "Docosahexaenoic acid"
dha_prs_df <- merge(dha_prs_df,phecode_map_df,by="phecode")
dha_prs_df <- dha_prs_df[dha_prs_df$category != "NULL", ]
dha_prs_df <- dha_prs_df[!(is.na(dha_prs_df$category)), ]
dha_prs_df <- dha_prs_df[dha_prs_df$category != "", ]
dha_prs_df$significance <- ifelse(dha_prs_df$pval< p_thresh, dha_prs_df$phenotype, "")
dha_prs_df$risk_prot <- ifelse(dha_prs_df$or > 1, "Risk", "Protective")
# Read and format O3FA results
o3fa_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/result_files/MASTER_01_16_2023_Phecodes_Zscore_O3FA_age_agesquare_sex_10PCS_glmresults.tsv"))
o3fa_df$phecode <- as.character(o3fa_df$phecode)
o3fa_df$label <- "Omega-3 fatty acids"
o3fa_df <- merge(o3fa_df,phecode_map_df,by="phecode")
o3fa_df <- o3fa_df[o3fa_df$category != "NULL", ]
o3fa_df <- o3fa_df[!(is.na(o3fa_df$category)), ]
o3fa_df <- o3fa_df[o3fa_df$category != "", ]
o3fa_df$significance <- ifelse(o3fa_df$pval< p_thresh, o3fa_df$phenotype, "")
o3fa_df$risk_prot <- ifelse(o3fa_df$or > 1, "Risk", "Protective")
# Read and format O6FA results
o6fa_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/result_files/MASTER_01_16_2023_Phecodes_Zscore_O6FA_age_agesquare_sex_10PCS_glmresults.tsv"))
o6fa_df$phecode <- as.character(o6fa_df$phecode)
o6fa_df$label <- "Omega-6 fatty acids"
o6fa_df <- merge(o6fa_df,phecode_map_df,by="phecode")
o6fa_df <- o6fa_df[o6fa_df$category != "NULL", ]
o6fa_df <- o6fa_df[!(is.na(o6fa_df$category)), ]
o6fa_df <- o6fa_df[o6fa_df$category != "", ]
o6fa_df$significance <- ifelse(o6fa_df$pval< p_thresh, o3fa_df$phenotype, "")
o6fa_df$risk_prot <- ifelse(o6fa_df$or > 1, "Risk", "Protective")
# Read and format DHA results
dha_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/result_files/MASTER_01_16_2023_Phecodes_Zscore_DHA_age_agesquare_sex_10PCS_glmresults.tsv"))
dha_df$phecode <- as.character(dha_df$phecode)
dha_df$label <- "Docosahexaenoic acid"
dha_df <- merge(dha_df,phecode_map_df,by="phecode")
dha_df <- dha_df[dha_df$category != "NULL", ]
dha_df <- dha_df[!(is.na(dha_df$category)), ]
dha_df <- dha_df[dha_df$category != "", ]
dha_df$significance <- ifelse(dha_df$pval< p_thresh, dha_df$phenotype, "")
dha_df$risk_prot <- ifelse(dha_df$or > 1, "Risk", "Protective")
#-------------------------------------------------------------------------
#--------------------Non-genetic association numbers----------------------
#--------------------------------O3FA-------------------------------------
# Number of total non-genetic associations O3FA
nrow(o3fa_df[o3fa_df$significance != "", ])
# Number of protective non-genetic associations O3FA
nrow(o3fa_df[(o3fa_df$significance != "") & (o3fa_df$risk_prot == "Protective"), ])
# Unique disease groups for protective associations O3FA
unique(o3fa_df[(o3fa_df$significance != "") & (o3fa_df$risk_prot == "Protective"), ]$category)
# Number of protective non-genetic associations O3FA
nrow(o3fa_df[(o3fa_df$significance != "") & (o3fa_df$risk_prot == "Risk"), ])
# Unique disease groups for risk associations O3FA
unique(o3fa_df[(o3fa_df$significance != "") & (o3fa_df$risk_prot == "Risk"), ]$category)
# Get significant O6FA associations
significant_o3fa_df <- o3fa_df[(o3fa_df$significance != "") & (o3fa_df$risk_prot == "Protective"), ]
significant_o3fa_df$label <- "Omega-3 fatty acids"
st1_df <- significant_o3fa_df[c("label","phenotype","category","n_case_samples","n_control_samples","estimate","se","z","lo_ci","hi_ci","or","pval")]
colnames(st1_df) <- c("metabolite","disease","disease_group","n_case_samples","n_control_samples","estimate","se","z","lo_ci","hi_ci","or","pval")
st1_df
write.table(st1_df,file="/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/tables/V2_ST2_nongenetic_O3FA.tsv",quote=FALSE,sep="\t",row.names=FALSE,col.names=TRUE)
library(ggplot2)
library(forcats)
library(tidyverse)
library(dplyr)
library(data.table)
library("ggpubr")
library(plyr)
library(stringr)
library(gridExtra)
library(ggpmisc)
covar_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/12_12_2022_UKBBCovariate_table.tsv"))
covar_df$ID <- paste0(covar_df$eid,"_",covar_df$eid,sep="")
covar_df$sex_corrected <- ifelse(covar_df$sex=="Male",1,0)
covar_df <- covar_df[c('ID','sex','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','sex_corrected')]
environment_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/Zscore_format_normalized_BodyCompositionFieldsUKBB.tsv"))
environment_df$ID <- paste0(environment_df$eid,"_",environment_df$eid,sep="")
environment_df <- environment_df[c('ID','BMI_median','WaistCircumference_median_to_HipCircumference_median_ratio')]
#Remove entries with missing values.
environment_df <- environment_df[!(is.na(environment_df$BMI_median)),]
environment_df <- environment_df[!(is.na(environment_df$WaistCircumference_median_to_HipCircumference_median_ratio)),]
merge_df <- merge(covar_df,environment_df,by="ID")
merge_df <- merge_df[merge_df$WaistCircumference_median_to_HipCircumference_median_ratio < 2, ]
merge_df$bmi_group <- ifelse(merge_df$BMI_median > 30,"BMI-Obese","BMI-Non-obese")
female_df <- merge_df[merge_df$sex_corrected == 0, ]
female_df$whr_group <- ifelse(female_df$WaistCircumference_median_to_HipCircumference_median_ratio > 0.85,"WHR-Obese","WHR-Non-obese")
male_df <- merge_df[merge_df$sex_corrected == 1, ]
male_df$whr_group <- ifelse(male_df$WaistCircumference_median_to_HipCircumference_median_ratio > 0.95,"WHR-Obese","WHR-Non-obese")
final_df <- rbind(male_df,female_df)
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
geom_point(size=2,alpha=0.1) + ylab("WHR") + xlab("BMI") + geom_bin2d() +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin2d(bins=100) +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_hex() +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_hex(bins=200) +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_hex(bins=100) +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_density2d() +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=300) +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=200) +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=200) +
scale_fill_continuous(type = "viridis") +
theme_bw() + theme(legend.position="none",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggsave("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/figures/SuppFig1_WHR_vs_BMI_density.jpg",height = 8,width = 8,dpi = 300,limitsize = FALSE)
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=200) +
scale_fill_continuous(type = "viridis") +
theme_bw() + theme(legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=200) +
scale_fill_continuous(type = "viridis") +
theme_bw() + theme(legend.key.width = unit(4, 'in'),legend.key.height= unit(1, 'in'),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=200) +
scale_fill_continuous(type = "viridis") +
theme_bw() + theme(legend.key.width = unit(1, 'in'),legend.key.height= unit(1, 'in'),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
ggplot(final_df, aes(x=BMI_median, y=WaistCircumference_median_to_HipCircumference_median_ratio)) +
ylab("WHR") + xlab("BMI") + geom_bin_2d(bins=200) +
scale_fill_continuous(type = "viridis") +
theme_bw() + theme(legend.key.width = unit(1, 'in'),legend.key.height= unit(0.5, 'in'),legend.position="bottom",text = element_text(family = "Helvetica",size=20),axis.text=element_text(size=20),axis.title=element_text(size=20), panel.border = element_rect(colour = "black", fill=NA, size=1))
library(forcats)
library(tidyverse)
library(dplyr)
library(data.table)
library("ggpubr")
library(plyr)
library(stringr)
disease_status_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/ALLmerged_extractPhecodes.lst"))
library(plyr)
library(stringr)
disease_status_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/V2_ALLmerged_extractPhecodes.lst"))
disease_status_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/V4_ALLmerged_extractPhecodes.lst"))
disease_status_df$ID <- paste0(disease_status_df$EID,"_",disease_status_df$EID,sep="")
prs_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/V2ALLmergedPRS_UKBB.tsv"))
covar_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/12_12_2022_UKBBCovariate_table.tsv"))
covar_df$ID <- paste0(covar_df$eid,"_",covar_df$eid,sep="")
covar_df$sex_corrected <- ifelse(covar_df$sex=="Male",1,0)
covar_df <- covar_df[c('ID','sex','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','sex_corrected')]
metabolite_df <- as.data.frame(fread("/Users/courtneyastore/Dropbox (GaTech)/metabolitexenvironment_disease_project/processing_files/Zscore_format_normalized_metabolite_table2_participant.tsv"))
metabolite_df$ID <- paste0(metabolite_df$eid,"_",metabolite_df$eid,sep="")
metabolite_pgs_covar_df <- merge(prs_df,covar_df,by="ID")
metabolite_pgs_covar_df <- merge(metabolite_pgs_covar_df,metabolite_df,by="ID")
disease_pgs_covar_df <- merge(prs_df,covar_df,by="ID")
disease_pgs_covar_df <- merge(disease_pgs_covar_df,disease_status_df,by="ID")
o3fa_df <- metabolite_pgs_covar_df
o3fa_df <- o3fa_df[c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','p23444_zscore','PRS_met-d-omega3_PRS')]
colnames(o3fa_df) <- c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','p23444_zscore','PRS')
o3fa_lm <- lm(PRS ~ p23444_zscore + age + age_square + sex_corrected + PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 + PC10, data = o3fa_df)
o3fa_p = coef(summary(o3fa_lm))[2,4] # P = 0
o3fa_lm
summary(o3fa_lm)
p
o3fa_p
o6fa_df <- metabolite_pgs_covar_df
o6fa_df <- o6fa_df[c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','p23445_zscore','PRS_met-d-omega6_PRS')]
colnames(o6fa_df) <- c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','p23445_zscore','PRS')
o6fa_lm <- lm(PRS ~ p23445_zscore + age + age_square + sex_corrected + PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 + PC10, data = o6fa_df)
o6fa_p = coef(summary(o6fa_lm))[2,4]
summary(o6fa_lm)
dha_df <- metabolite_pgs_covar_df
dha_df <- dha_df[c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','p23450_zscore','PRS_met-d-dha_PRS')]
colnames(dha_df) <- c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','p23450_zscore','PRS')
dha_lm <- lm(PRS ~ p23450_zscore + age + age_square + sex_corrected + PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 + PC10, data = dha_df)
dha_p = coef(summary(dha_lm))[2,4] # P = 0
summary(dha_lm)
depression_df <- disease_pgs_covar_df
depression_df <- depression_df[depression_df$Status_296.22 != "Excluded", ]
depression_df$disease_status <- ifelse(depression_df$Status_296.22 == "Case", 1, 0)
depression_df <- depression_df[c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','disease_status','PRS_ieu-a-1188_PRS')]
colnames(depression_df) <- c('ID','sex_corrected','age','age_square','PC1','PC2','PC3','PC4','PC5','PC6','PC7','PC8','PC9','PC10','disease_status','PRS')
depression_lm <- lm(PRS ~ disease_status + age + age_square + sex_corrected + PC1 + PC2 + PC3 + PC4 + PC5 + PC6 + PC7 + PC8 + PC9 + PC10, data = depression_df)
depression_p = coef(summary(depression_lm))[2,4]
summary(depression_lm)
depression_lm_nagelkerke_r2 <- pseudoR2(depression_lm, which = "nagelkerke")
library(rsq)
depression_lm_nagelkerke_r2 <- pseudoR2(depression_lm, which = "nagelkerke")
library(rsq)
depression_lm_nagelkerke_r2 <- pseudoR2(depression_lm, which = "nagelkerke")
library(fmsb)
install.packages(fmsb)
install.packages("fmsb")
library(fmsb)
depression_lm_nagelkerke_r2 <- pseudoR2(depression_lm, which = "nagelkerke")
library(DescTools)
depression_lm_nagelkerke_r2 <- DescTools::PseudoR2(depression_lm, which = "Nagelkerke")
depression_lm_nagelkerke_r2
depression_lm_nagelkerke_r2 <- rsq::nagelkerke(depression_lm)
library(rsq)
depression_lm_nagelkerke_r2 <- rsq::nagelkerke(depression_lm)
NagelkerkeR2(depression_lm)
depression_lm
NagelkerkeR2(summary(depression_lm))
